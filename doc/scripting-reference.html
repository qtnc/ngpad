<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Scripting reference</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Scripting reference</h1>
</header>
<h2 id="app">App</h2>
<p>Type representing the application. A single instance of this type
exists, under the global variable <code>app</code>.</p>
<h3 id="appexecute-command">app:execute (command)</h3>
<p>Execute a command and put the result in a new tab/window. This is
equivalent to Tools&gt;Run... or F10</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>command: string: command to execute</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the execution succeeded.</li>
</ul>
<h3 id="appgetclipboardtext-">App.getClipboardText ()</h3>
<p>Get the current text of the clipboard</p>
<p><strong>Returns:</strong></p>
<ul>
<li>string: text of the clipboard</li>
</ul>
<h3 id="appgetconfig-key">app:getConfig (key)</h3>
<p>Get a configuration key</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>key: string: the configuration key to get</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the configuration value, or an empty string if nothing is
defined for that key</li>
</ul>
<h3 id="appgettranslation-key">app:getTranslation (key)</h3>
<p>Get a translation key</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>key: string: the translation key to get</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the translation corresponding to that key, or an empty
string if it was not found</li>
</ul>
<h3 id="appopendocument-filename">app:openDocument (filename)</h3>
<p>Open the specified filename, or reactivate (put its tab/window in
front) if it's already open</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>filename: string: file to open or reactivate</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>Document: the document opened or reactivated</li>
</ul>
<h3 id="appopennewdocument-">app:openNewDocument ()</h3>
<p>Open a new tab/window with an empty document</p>
<h3 id="appquickjump-command">app:quickJump (command)</h3>
<p>Execute a quick jump command. This is equivalent to Ctrl+J</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>command: string: quick jump command to execute</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the quick jump command succeeded</li>
</ul>
<h3 id="appsaytext-text">App.sayText (text)</h3>
<p>send some text to the live region, to be spoken by screen readers</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>text: string: text to be spoken by screen readers</li>
</ul>
<h3 id="appsetclipboardtext-text">App.setClipboardText (text)</h3>
<p>Set the text of the clipboard</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>text: string: text to put into the clipboard</li>
</ul>
<h3 id="properties">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>applicationDirectory</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>directory where the executable of the application is found</td>
</tr>
<tr class="even">
<td>currentDocument</td>
<td>Document</td>
<td>true</td>
<td>false</td>
<td>The currently active document</td>
</tr>
<tr class="odd">
<td>documents</td>
<td>table</td>
<td>true</td>
<td>false</td>
<td>Table of all documents currently opened in the application</td>
</tr>
<tr class="even">
<td>locale</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>current language of the application</td>
</tr>
<tr class="odd">
<td>userDataDirectory</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>directory where user settings are stored</td>
</tr>
<tr class="even">
<td>userLocalDataDirectory</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>directory where local user settings are stored</td>
</tr>
</tbody>
</table>
<h2 id="commandevent">CommandEvent</h2>
<p>Event for all command-based simple events</p>
<h3 id="properties-1">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>checked</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if the element or item was just checked or unchecked</td>
</tr>
<tr class="even">
<td>extraLong</td>
<td>integer</td>
<td>true</td>
<td>true</td>
<td>second additional information of type integer. The kind of
information depends on the event type.</td>
</tr>
<tr class="odd">
<td>int</td>
<td>integer</td>
<td>true</td>
<td>true</td>
<td>additional information of type integer. The kind of information
depends on the event type.</td>
</tr>
<tr class="even">
<td>selection</td>
<td>integer</td>
<td>true</td>
<td>true</td>
<td>the 0-based index of the element or item just selected</td>
</tr>
<tr class="odd">
<td>string</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>additional information of type string. The kind of information
depends on the event type.</td>
</tr>
</tbody>
</table>
<h3 id="constants">Constants</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CONTEXT_MENU</td>
<td>integer</td>
<td>event type identifier for calling the context menu (right click,
Shift+F10 or application key)</td>
</tr>
<tr class="even">
<td>MENU</td>
<td>integer</td>
<td>type identifier for menu item selection event</td>
</tr>
<tr class="odd">
<td>TEXT_ENTER</td>
<td>integer</td>
<td>event type identifier for pressing enter in the edition area</td>
</tr>
<tr class="even">
<td>TOOL</td>
<td>integer</td>
<td>event identifier for tool selection event</td>
</tr>
<tr class="odd">
<td>TOOL_ENTER</td>
<td>integer</td>
<td>event type identifier for activating a tool event</td>
</tr>
<tr class="even">
<td>TOOL_RCLICKED</td>
<td>integer</td>
<td>event type identifier for right clicking on a tool event</td>
</tr>
</tbody>
</table>
<h2 id="dialogs">Dialogs</h2>
<p>Standard dialog boxes and other utilities related to dialog boxes</p>
<h3 id="dialogsalert-message-title">Dialogs.alert (message, title)</h3>
<p>Display a simple dialog box with an OK button, suitable for an
informational message</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: message displayed in the dialog box</li>
<li>title: string: title of the dialog box</li>
</ul>
<h3 id="dialogsbrowse-url">Dialogs.browse (url)</h3>
<p>Open the default browser of the system and navigate to the given
URL</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>url: string: URL to open</li>
</ul>
<h3
id="dialogschooseone-message-title-options-selection0-sortedfalse">Dialogs.chooseOne
(message, title, options, selection=0, sorted=false)</h3>
<p>Prompts the user to choose a single option among a list</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: accompagning message displayed above the list of
options</li>
<li>title: string: title of the dialog box</li>
<li>options: table: a table of options the user can choose from</li>
<li>selection: integer: 1-based index of the option initially selected
when the dialog box opens, or 0 to not select anything by default.</li>
<li>sorted: boolean: true to automatically sort items in the list</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the 1-based index of the option selected, or nil if the
user cancelled the dialog box</li>
<li>string: the string value of the selected option, or nil if the user
cancelled the dialog box</li>
</ul>
<h3 id="dialogsconfirm-message-title">Dialogs.confirm (message,
title)</h3>
<p>Display a simple dialog box with Yes/No buttons</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: message displayed in the dialog box</li>
<li>title: string: title of the dialog box</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the user chose Yes, false if the user chose No or
closed the dialog box</li>
</ul>
<h3 id="dialogserror-message-title">Dialogs.error (message, title)</h3>
<p>Display a simple dialog box with an OK button, suitable for an error
message</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: message displayed in the dialog box</li>
<li>title: string: title of the dialog box</li>
</ul>
<h3 id="dialogsmessagebox-message-title-style">Dialogs.messageBox
(message, title, style)</h3>
<p>Display a simple dialog box with a combination of standard
buttons</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: message displayed in the dialog box</li>
<li>title: string: title of the dialog box</li>
<li>style: integer: a combination of values telling which buttons and
which icon to show.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the ID_XXX value corresponding to the button clicked by the
user.</li>
</ul>
<h3
id="dialogsmessageboxex-message-title-buttons-defaultbutton1-cancelbutton0">Dialogs.messageBoxEx
(message, title, buttons, defaultButton=1, cancelButton=0)</h3>
<p>Display a simple dialog box with a message and custom buttons</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: message displayed in the dialog box</li>
<li>title: string: title of the dialog box</li>
<li>buttons: table: list of buttons to display in the dialog box</li>
<li>defaultButton: integer: 1-based index of the default button
initially selected when the dialog box opens</li>
<li>cancelButton: integer: 1-based index of a button that will be
triggered when escape is pressed. By default, escape doesn't allow to
close implicitly the dialog box.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the 1-based index of the button selected by the user</li>
</ul>
<h3
id="dialogsmessagedetailbox-message-title-hint-style">Dialogs.messageDetailBox
(message, title, hint, style)</h3>
<p>Show a dialog box with a short text, and a longer text that can be
shown when pressing on a detail toggle button</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: a long message that will initially be hidden</li>
<li>title: string: title of the dialog box</li>
<li>hint: string: short text which will always be visible</li>
<li>style: integer: a value indicating which standard buttons and icons
to show</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the ID of the button clicked by the user</li>
</ul>
<h3
id="dialogsopendirectory-title-directory-multiplefalse">Dialogs.openDirectory
(title, directory, multiple=false)</h3>
<p>Open a dialog box where the user can choose one or more directories
to open</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>title: string: title of the dialog box</li>
<li>directory: string: directory initially open when the dialog
opens</li>
<li>multiple: boolean: whether the user can choose multiple directories
(true) or only a single one (false, default)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>table: If the user selected one or more directories to open, a table
of directories is returned, otherwise nil if the user cancelled the
dialog box.</li>
</ul>
<h3
id="dialogsopenfile-title-directory-filename-filter-multiplefalse">Dialogs.openFile
(title, directory, filename, filter, multiple=false)</h3>
<p>Open a dialog box where the user can choose one or more files to
open</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>title: string: title of the dialog box</li>
<li>directory: string: directory initially open when the dialog
opens</li>
<li>filename: string: Name of the file initially selected when the
dialog box opens</li>
<li>filter: string: List of filters in a form like '*.txt|Text
files'</li>
<li>multiple: boolean: whether the user can choose multiple files (true)
or only a single one (false, default)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>table: If the user selected one or more files to open, a table of
filenames is returned, otherwise nil if the user cancelled the dialog
box.</li>
</ul>
<h3 id="dialogsprompt-message-title-value">Dialogs.prompt (message,
title, value)</h3>
<p>prompts the user to enter some single line text</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: accompagning message displayed above the input text
field</li>
<li>title: string: title of the dialog box</li>
<li>value: string: the initial text value present in the text field when
the dialog opens</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: if the user clicked OK, the entered text is returned,
otherwise nil if the user cancelled the dialog box.</li>
</ul>
<h3
id="dialogspromptcredentials-message-title-username-password">Dialogs.promptCredentials
(message, title, username, password)</h3>
<p>prompts the user to enter some credentials, i.e. username and
password</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: accompagning message displayed above the input text
field</li>
<li>title: string: title of the dialog box</li>
<li>username: string: the initial username when the dialog opens</li>
<li>password: string: initial password when the dialog opens</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: entered username, or nil if the user cancelled the dialog
box</li>
<li>string: entered password, or nil if the user cancelled the dialog
box</li>
</ul>
<h3
id="dialogspromptnumber-message-title-prompt-value0-min0-max100">Dialogs.promptNumber
(message, title, prompt, value=0, min=0, max=100)</h3>
<p>prompts the user to enter an integer number</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: accompagning message displayed above the input text
field</li>
<li>title: string: title of the dialog box</li>
<li>prompt: string: accompagning message displayed on the left of the
input text field</li>
<li>value: integer: the initial value present in the input field when
the dialog opens</li>
<li>min: integer: minimum value the user is allowed to enter</li>
<li>max: integer: maximum value the user is allowed to enter</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: if the user clicked OK, the entered value is returned,
otherwise nil if the user cancelled the dialog box.</li>
</ul>
<h3
id="dialogspromptpassword-message-title-value">Dialogs.promptPassword
(message, title, value)</h3>
<p>prompts the user to enter a password</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: accompagning message displayed above the input text
field</li>
<li>title: string: title of the dialog box</li>
<li>value: string: the initial text value present in the text field when
the dialog opens</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: if the user clicked OK, the entered text is returned,
otherwise nil if the user cancelled the dialog box.</li>
</ul>
<h3 id="dialogssavedirectory-title-directory">Dialogs.saveDirectory
(title, directory)</h3>
<p>Open a dialog box where the user can choose a directory to save
into.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>title: string: title of the dialog box</li>
<li>directory: string: directory initially open when the dialog
opens</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: If the user selected a directory, it is returned, otherwise
nil if the user cancelled the dialog box.</li>
</ul>
<h3
id="dialogssavefile-title-directory-filename-filter">Dialogs.saveFile
(title, directory, filename, filter)</h3>
<p>Open a dialog box where the user can choose a file to save to.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>title: string: title of the dialog box</li>
<li>directory: string: directory initially open when the dialog
opens</li>
<li>filename: string: Name of the file initially selected when the
dialog box opens</li>
<li>filter: string: List of filters in a form like '*.txt|Text
files'</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: if the user selected a file, it is returned, otherwise nil
if the user cancelled the dialog box.</li>
</ul>
<h3 id="dialogswarning-message-title">Dialogs.warning (message,
title)</h3>
<p>Display a simple dialog box with an OK button, suitable for a warning
message</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>message: string: message displayed in the dialog box</li>
<li>title: string: title of the dialog box</li>
</ul>
<h3 id="dialogswebviewbox-url">Dialogs.webViewBox (url)</h3>
<p>Open a dialog box presenting a web page</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>url: string: URL of the web page to show. Can also be some HTML code
directly.</li>
</ul>
<h3 id="constants-1">Constants</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>APPLY</td>
<td>integer</td>
<td>flag telling that the Apply button must be shown</td>
</tr>
<tr class="even">
<td>CANCEL</td>
<td>integer</td>
<td>flag telling that the Cancel button must be shown</td>
</tr>
<tr class="odd">
<td>CANCEL_DEFAULT</td>
<td>integer</td>
<td>Flag indicating that the Cancel button should be selected by
default</td>
</tr>
<tr class="even">
<td>CLOSE</td>
<td>integer</td>
<td>flag telling that the Close button must be shown</td>
</tr>
<tr class="odd">
<td>HELP</td>
<td>integer</td>
<td>flag telling that the Help button must be shown</td>
</tr>
<tr class="even">
<td>ICON_AUTH_NEEDED</td>
<td>integer</td>
<td>Flag to display an icon of a shield</td>
</tr>
<tr class="odd">
<td>ICON_ERROR</td>
<td>integer</td>
<td>Flag to display an error icon</td>
</tr>
<tr class="even">
<td>ICON_EXCLAMATION</td>
<td>integer</td>
<td>Flag to display an exclamative icon</td>
</tr>
<tr class="odd">
<td>ICON_INFORMATION</td>
<td>integer</td>
<td>Flag to display an informative icon</td>
</tr>
<tr class="even">
<td>ICON_NONE</td>
<td>integer</td>
<td>Flag to display no particular icon</td>
</tr>
<tr class="odd">
<td>ICON_QUESTION</td>
<td>integer</td>
<td>Flag to display an interrogative icon</td>
</tr>
<tr class="even">
<td>ICON_WARNING</td>
<td>integer</td>
<td>Flag to display a warning icon</td>
</tr>
<tr class="odd">
<td>ID_APPLY</td>
<td>integer</td>
<td>identifier of the Apply button</td>
</tr>
<tr class="even">
<td>ID_CANCEL</td>
<td>integer</td>
<td>identifier of the Cancel button</td>
</tr>
<tr class="odd">
<td>ID_CLOSE</td>
<td>integer</td>
<td>identifier of the Close button</td>
</tr>
<tr class="even">
<td>ID_HELP</td>
<td>integer</td>
<td>identifier of the Help button</td>
</tr>
<tr class="odd">
<td>ID_NO</td>
<td>integer</td>
<td>identifier of the No button</td>
</tr>
<tr class="even">
<td>ID_OK</td>
<td>integer</td>
<td>identifier of the OK button</td>
</tr>
<tr class="odd">
<td>ID_YES</td>
<td>integer</td>
<td>identifier of the Yes button</td>
</tr>
<tr class="even">
<td>NO</td>
<td>integer</td>
<td>flag telling that the No button must be shown</td>
</tr>
<tr class="odd">
<td>NO_DEFAULT</td>
<td>integer</td>
<td>Flag indicating that the No button should be selected by
default</td>
</tr>
<tr class="even">
<td>OK</td>
<td>integer</td>
<td>flag telling that the OK button must be shown</td>
</tr>
<tr class="odd">
<td>OK_DEFAULT</td>
<td>integer</td>
<td>Flag indicating that the OK button should be selected by
default</td>
</tr>
<tr class="even">
<td>YES</td>
<td>integer</td>
<td>flag telling that the Yes button must be shown</td>
</tr>
<tr class="odd">
<td>YES_DEFAULT</td>
<td>integer</td>
<td>Flag indicating that the Yes button should be selected by
default</td>
</tr>
<tr class="even">
<td>YES_NO</td>
<td>integer</td>
<td>flag telling that the Yes and No buttons must be shown</td>
</tr>
</tbody>
</table>
<h2 id="document">Document</h2>
<p>Type representing a document currently opened in the application</p>
<h3 id="documentactivate-">document:activate ()</h3>
<p>Activate the document and make it visible</p>
<h3
id="documentbindaccelerator-accelerator-action">document:bindAccelerator
(accelerator, action)</h3>
<p>Bind an accelerator to an action</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>accelerator: string: accelerator to bind</li>
<li>action: function: action to execute when the accelerator is
triggered</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>handler: an object that can be passed to unbind() in order to cancel
the event</li>
</ul>
<h3 id="documentclose-">document:close ()</h3>
<p>Close the document</p>
<h3 id="documentgetproperty-key">document:getProperty (key)</h3>
<p>Get a property of this document</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>key: string: name of the property to get</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>any: value of the property or nil if not found</li>
</ul>
<h3 id="documentreload-">document:reload ()</h3>
<p>Reload the document from disk and update the display.</p>
<h3 id="documentrevert-">document:revert ()</h3>
<p>Revert the document to the state of its last save.</p>
<h3 id="documentsave-">document:save ()</h3>
<p>Save the document</p>
<h3 id="documentsaveas-">document:saveAs ()</h3>
<p>Save the document under another name. This opens the "Save as" dialog
box.</p>
<h3 id="documentsetproperty-key-value">document:setProperty (key,
value)</h3>
<p>Sets a property for this document</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>key: string: name of the property to set</li>
<li>value: any: value to set</li>
</ul>
<h3 id="properties-2">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>alreadySaved</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if the document hasn't been modified since the last save</td>
</tr>
<tr class="even">
<td>editor</td>
<td>TextEditor</td>
<td>true</td>
<td>false</td>
<td>Text edition zone of the document</td>
</tr>
<tr class="odd">
<td>filename</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>File name from and into which the document is loaded and saved on
disk</td>
</tr>
<tr class="even">
<td>menus</td>
<td>MenuBar</td>
<td>true</td>
<td>false</td>
<td>Menu bar of the document</td>
</tr>
<tr class="odd">
<td>modified</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>tells if the document has been modified since its last save.</td>
</tr>
<tr class="even">
<td>properties</td>
<td>table</td>
<td>true</td>
<td>true</td>
<td>all properties of the document</td>
</tr>
<tr class="odd">
<td>saved</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>tells if the document has already been saved</td>
</tr>
<tr class="even">
<td>status</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>content of the status bar</td>
</tr>
<tr class="odd">
<td>title</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>Title of the window or tab for this document</td>
</tr>
<tr class="even">
<td>tools</td>
<td>ToolBar</td>
<td>true</td>
<td>false</td>
<td>Toolbar of the document</td>
</tr>
<tr class="odd">
<td>type</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>type of document</td>
</tr>
</tbody>
</table>
<h2 id="event">Event</h2>
<p>Parent class of all events</p>
<h3 id="eventskip-skiptrue">event:skip (skip=true)</h3>
<p>Set the skip state of the event</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>skip: boolean: skip state</li>
</ul>
<h3 id="properties-3">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>document</td>
<td>Document document in which the event took place</td>
<td>true</td>
<td>false</td>
<td></td>
</tr>
<tr class="even">
<td>id</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>ID of the element or control where the event took place</td>
</tr>
<tr class="odd">
<td>skipped</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>skipped state of the event</td>
</tr>
<tr class="even">
<td>timestamp</td>
<td>integer</td>
<td>true</td>
<td>true</td>
<td>timestamp of the event</td>
</tr>
<tr class="odd">
<td>type</td>
<td>integer</td>
<td>true</td>
<td>true</td>
<td>type of the event</td>
</tr>
</tbody>
</table>
<h2 id="eventhandler">EventHandler</h2>
<p>Base class of all elements and controls that can react to events</p>
<h3 id="eventhandlerbind-type-fromid-toid-handler">eventHandler:bind
(type, fromId, toId, handler)</h3>
<p>Bind an event</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>type: integer: type of event</li>
<li>fromId: integer: minimum ID for which the event must be processed.
This parameter can be totally omited.</li>
<li>toId: integer: maximum ID for which the event must be processed.
This parameter can be totally omited.</li>
<li>handler: function: event function to call when the event occurrs.
The function must always be the last parameter.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>handler: an object that can be passed to unbind() in order to cancel
the event</li>
</ul>
<h3 id="eventhandlerunbind-handler">eventHandler:unbind (handler)</h3>
<p>unbind an event previously bount with bind()</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>handler: handler: event handler to unbind</li>
</ul>
<h3 id="constants-2">Constants</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DOC_CLOSED</td>
<td>integer</td>
<td>type identifier for document closed event, triggered when a document
has been closed</td>
</tr>
<tr class="even">
<td>DOC_CLOSING</td>
<td>integer</td>
<td>type identifier for document closing event, triggered when a
document is about to be closed</td>
</tr>
<tr class="odd">
<td>DOC_CREATED</td>
<td>integer</td>
<td>type identifier for document created event, triggered when a
document has been created</td>
</tr>
<tr class="even">
<td>DOC_CREATING</td>
<td>integer</td>
<td>type identifier for document creating event, triggered when a
document is about to be created</td>
</tr>
<tr class="odd">
<td>DOC_LOADED</td>
<td>integer</td>
<td>type identifier for document loaded event, triggered when a document
has been loaded from file</td>
</tr>
<tr class="even">
<td>DOC_LOADING</td>
<td>integer</td>
<td>type identifier for document loading event, triggered when a
document is about to be loaded from a file</td>
</tr>
<tr class="odd">
<td>DOC_SAVED</td>
<td>integer</td>
<td>type identifier for document saved event, triggered when a document
has been saved to file</td>
</tr>
<tr class="even">
<td>DOC_SAVING</td>
<td>integer</td>
<td>type identifier for document saving event, triggered when a document
is about to be saved to file</td>
</tr>
</tbody>
</table>
<h2 id="inputstream">InputStream</h2>
<p>Input stream class</p>
<h3 id="inputstream-file">InputStream (file)</h3>
<p>Create a new input stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>file: string|Path: file name or path object referencing the file to
open</li>
</ul>
<h3 id="inputstreamcanread-">inputStream:canRead ()</h3>
<p>Checks if the stream can be read without blocking</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if a read operation can be done without blocking</li>
</ul>
<h3 id="inputstreamclose-">inputStream:close ()</h3>
<p>Closes the stream</p>
<h3 id="inputstreamfrom-content">InputStream.from (content)</h3>
<p>Create an input stream from an input string</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>content: string: content of the input stream</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>InputStream: created input stream</li>
</ul>
<h3 id="inputstreamread-count-timeout0">inputStream:read (count,
timeout=0)</h3>
<p>Read contents from the stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>count: integer: maximum number of bytes to read from the stream</li>
<li>timeout: integer: the maximum amount of time (in miliseconds) to
wait for contents, 0 or negative means infinite</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: content read from the stream. It may be less than the
maximum requested, including 0. Note that the string is returned as it
is read. It may not be encoded in UTF-8, and may even be binary data not
humanly readable.</li>
</ul>
<h3 id="inputstreamreadall-timeout0">inputStream:readAll
(timeout=0)</h3>
<p>Read all the contents til the end of the stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>timeout: integer: the maximum amount of time (in miliseconds) to
wait for contents, 0 or negative means infinite</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: content read from the stream. Note that the string is
returned as it is read. It may not be encoded in UTF-8, and may even be
binary data not humanly readable.</li>
</ul>
<h3 id="inputstreamreadline-timeout0">inputStream:readLine
(timeout=0)</h3>
<p>Read a line of text from the stream, until \n or \r\n, without
including it in the returned string. Note that the string is returned as
it is read. It may not be encoded in UTF-8, and may even be binary data
not humanly readable.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>timeout: integer: the maximum amount of time (in miliseconds) to
wait for contents, 0 or negative means infinite</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: content read from the stream. Note that the string is
returned as it is read. It may not be encoded in UTF-8, and may even be
binary data not humanly readable.</li>
</ul>
<h3 id="inputstreamreadto-out">inputStream:readTo (out)</h3>
<p>Write all content read from this input stream to an output stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>out: OutputStream: Output stream to write to</li>
</ul>
<h3 id="inputstreamseek-position-modecurrent">inputStream:seek
(position, mode='current')</h3>
<p>Seek in the stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>position: integer: position to seek to</li>
<li>mode: string: one of 'begin', 'current' or 'end' to seek
respectively from the beginning of the stream, its current position, or
from the end.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the new position of the stream, or -1 if unknown</li>
</ul>
<h3 id="inputstreamtell-">inputStream:tell ()</h3>
<p>Tell the current position of the stream</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the current position of the stream, or -1 if unknown</li>
</ul>
<h3 id="inputstreamunread-data">inputStream:unread (data)</h3>
<p>Put back some content in the stream. That content will be read
again.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>data: string: data to put back in the stream</li>
</ul>
<h2 id="keyevent">KeyEvent</h2>
<p>Event class for all keyboard-related events</p>
<h3 id="properties-4">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>altDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Alt key down?</td>
</tr>
<tr class="even">
<td>cmdDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is command key down?</td>
</tr>
<tr class="odd">
<td>controlDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Ctrl key down?</td>
</tr>
<tr class="even">
<td>ctrlDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Ctrl key down?</td>
</tr>
<tr class="odd">
<td>keyCode</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>key code of the key, see VK_XXX constants</td>
</tr>
<tr class="even">
<td>metaDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is meta key down?</td>
</tr>
<tr class="odd">
<td>modifiers</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>modifiers of the key, see MOD_XXX constants</td>
</tr>
<tr class="even">
<td>rawControlDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Ctrl key down?</td>
</tr>
<tr class="odd">
<td>shiftDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Shift key down?</td>
</tr>
<tr class="even">
<td>unicodeKey</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>unicode character corresponding to the key</td>
</tr>
</tbody>
</table>
<h3 id="constants-3">Constants</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CHAR</td>
<td>integer</td>
<td>event type identifier for character key press event</td>
</tr>
<tr class="even">
<td>CHAR_HOOK</td>
<td>integer</td>
<td>event type identifier for character key press event</td>
</tr>
<tr class="odd">
<td>KEY_DOWN</td>
<td>integer</td>
<td>event type identifier for key down event</td>
</tr>
<tr class="even">
<td>KEY_UP</td>
<td>integer</td>
<td>event type identifier for key up event</td>
</tr>
</tbody>
</table>
<h2 id="menu">Menu</h2>
<p>Type representing a menu, whether a menu in the menubar, or a popup
menu</p>
<h3
id="menuadd-label-submenu-helpstring-position0-id0-checkablefalse-radiofalse-checkedfalse">menu:add
(label, subMenu, helpString, position=0, id=0, checkable=false,
radio=false, checked=false)</h3>
<p>Add a new menu item to this menu</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>label: string: text label of the item</li>
<li>subMenu: Menu: a submenu to attach to this item</li>
<li>helpString: string: the help string displayed on the status bar when
the item is highlighted</li>
<li>position: integer: position of the item inside the menu
(1-based)</li>
<li>id: integer: unique identifier of the item (0 = automatically
allocate any ID)</li>
<li>checkable: boolean: tells if the menu item is checkable, i.e. has a
checkbox that can be checked</li>
<li>radio: boolean: Tells if this menu item is a radio button item</li>
<li>checked: boolean: Tells if this menu item is checked</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>MenuItem: the item created and added in this menu</li>
</ul>
<h3 id="menuaddseparator-position0">menu:addSeparator (position=0)</h3>
<p>add a separator to this menu</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>position: integer: position of the item in the menu (1-based)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>MenuItem: item created and added in this menu</li>
</ul>
<h3 id="menucheck-id-checkedtrue">menu:check (id, checked=true)</h3>
<p>Check a menu item by its ID</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: ID of the item to check or uncheck</li>
<li>checked: boolean: state checked or unchecked to apply</li>
</ul>
<h3 id="menuchooseone-options">Menu.chooseOne (options)</h3>
<p>Show a popup/context menu with simple text options to choose from</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>options: table: a table of options to choose from</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the 1-based index of the options selected by the user, 0 or
-1 if the menu has been closed without choosing any option</li>
</ul>
<h3 id="menuenable-id-enabledtrue">menu:enable (id, enabled=true)</h3>
<p>Enable a menu item by its ID</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: ID of the item to enable or disable</li>
<li>enabled: boolean: state enabled or disabled to apply</li>
</ul>
<h3 id="menugetmenuitemcount-">menu:getMenuItemCount ()</h3>
<p>Return the number of items present in this menu</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the number of items present in this menu</li>
</ul>
<h3 id="menuischecked-id">menu:isChecked (id)</h3>
<p>Tells if a given menu item is checked</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: Id of the menu item to check</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the given menu item exists and is checked</li>
</ul>
<h3 id="menuisenabled-id">menu:isEnabled (id)</h3>
<p>Tells if a menu item given by its ID is enabled</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: ID of the menu item to check</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the given item exists and is enabled</li>
</ul>
<h3 id="menuremove-itemorid">menu:remove (itemOrId)</h3>
<p>Remove an item from this menu</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>itemOrId: integer | MenuItem: the item to remove from this menu,
whether a MenuItem object, or an integer denothing the 1-based position
or the unique identifier of the item</li>
</ul>
<h3 id="menushow-">menu:show ()</h3>
<p>Displays this menu as a popup/context menu</p>
<h3 id="properties-5">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>internal name of this menu</td>
</tr>
<tr class="even">
<td>parent</td>
<td>Menu</td>
<td>true</td>
<td>false</td>
<td>parent menu of this menu</td>
</tr>
</tbody>
</table>
<h2 id="menubar">MenuBar</h2>
<p>Type representing the menu bar of a document window or tab</p>
<h3 id="menubaradd-label-menu-position0">menuBar:add (label, menu,
position=0)</h3>
<p>Add a new menu in this menu bar</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>label: string: the text label of the menu, displayed in the menu
bar</li>
<li>menu: Menu: the menu to add</li>
<li>position: integer: the 1-based position where to add the new
menu</li>
</ul>
<h3 id="menubarcheck-id-checkedtrue">menuBar:check (id,
checked=true)</h3>
<p>Check or uncheck a menu item by its ID</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: menu item ID</li>
<li>checked: boolean: state checked or unchecked to apply</li>
</ul>
<h3 id="menubarenable-id-enabletrue">menuBar:enable (id,
enable=true)</h3>
<p>Enable or disable a menu item by its ID</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: menu item ID</li>
<li>enable: boolean: enabled or disabled state to apply</li>
</ul>
<h3 id="menubargetmenu-indexorname">menuBar:getMenu (indexOrName)</h3>
<p>fetch a menu from this menu bar</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>indexOrName: integer | string: 1-based index or name of the menu to
fetch</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>Menu: the requested menu</li>
</ul>
<h3 id="menubargetmenucount-">menuBar:getMenuCount ()</h3>
<p>Return the number of menus present in this menu bar</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the number of menus in this menu bar</li>
</ul>
<h3 id="menubarischecked-id">menuBar:isChecked (id)</h3>
<p>Checks the checked state of a menu item by its ID</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: ID of the menu item</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: checked state</li>
</ul>
<h3 id="menubarisenabled-id">menuBar:isEnabled (id)</h3>
<p>Checks if a menu item is enabled or disabled by its ID</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>id: integer: menu item ID</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: enabled or disabled state</li>
</ul>
<h3 id="menubarremove-index">menuBar:remove (index)</h3>
<p>Remove a menu from this menu bar</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>index: integer: 1-based index of the menu to remove</li>
</ul>
<h2 id="menuitem">MenuItem</h2>
<p>Type representing a single menu item</p>
<h3 id="menuitembind-handler">menuItem:bind (handler)</h3>
<p>Bind an event handler to this item</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>handler: function: the event handler to bind to this item</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>handler: an object allowing to unbind the event handler later
on</li>
</ul>
<h3 id="menuitemcheck-checkedtrue">menuItem:check (checked=true)</h3>
<p>Checks or unchecks the checkbox of this item</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>checked: boolean: The state checked or unchecked to apply</li>
</ul>
<h3 id="menuitemenable-enabledtrue">menuItem:enable (enabled=true)</h3>
<p>Enable or disable this item</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>enabled: boolean: the enabled or disabled state to apply</li>
</ul>
<h3 id="properties-6">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>checkable</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>Tells if this item is checkable, i.e. if it has a checkbox</td>
</tr>
<tr class="even">
<td>checked</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>Tells if this item is currently checked</td>
</tr>
<tr class="odd">
<td>enabled</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>Tells if this item is currently enabled</td>
</tr>
<tr class="even">
<td>helpString</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>the help string associated with this item. The help string is
displayed in the status bar while the item is highlighted.</td>
</tr>
<tr class="odd">
<td>id</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>unique identifier of this item</td>
</tr>
<tr class="even">
<td>label</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>the text label of this item</td>
</tr>
<tr class="odd">
<td>labelText</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>the text label of this item, without including accelerators</td>
</tr>
<tr class="even">
<td>menu</td>
<td>Menu</td>
<td>true</td>
<td>true</td>
<td>the parent menu of this item</td>
</tr>
<tr class="odd">
<td>radio</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>Tells if this item is checkable and if it's a radio button</td>
</tr>
<tr class="even">
<td>separator</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>Tells if this item is a separator</td>
</tr>
<tr class="odd">
<td>subMenu</td>
<td>Menu</td>
<td>true</td>
<td>true</td>
<td>the submenu included in this item</td>
</tr>
</tbody>
</table>
<h2 id="mouseevent">MouseEvent</h2>
<p>Class for mouse events</p>
<h3 id="mouseeventgetposition-">mouseEvent:getPosition ()</h3>
<p>get the position of the mouse</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: X coordinate</li>
<li>integer: Y coordinate</li>
</ul>
<h3 id="properties-7">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>altDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Alt key down?</td>
</tr>
<tr class="even">
<td>button</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>flags indicating which buttons where down</td>
</tr>
<tr class="odd">
<td>clickCount</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>number of consecutive clicks (1=single click, 2=double click,
3=triple click)</td>
</tr>
<tr class="even">
<td>cmdDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is command key down?</td>
</tr>
<tr class="odd">
<td>controlDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Ctrl key down?</td>
</tr>
<tr class="even">
<td>ctrlDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Ctrl key down?</td>
</tr>
<tr class="odd">
<td>leftDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is the left button down?</td>
</tr>
<tr class="even">
<td>metaDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is meta key down?</td>
</tr>
<tr class="odd">
<td>middleDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is the middle button down?</td>
</tr>
<tr class="even">
<td>modifiers</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>modifier keys (see MOD_XXX constants)</td>
</tr>
<tr class="odd">
<td>rawControlDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Ctrl key down?</td>
</tr>
<tr class="even">
<td>rightDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is the right button down?</td>
</tr>
<tr class="odd">
<td>shiftDown</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>is Shift key down?</td>
</tr>
<tr class="even">
<td>wheelRotation</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>rotation of the mouse wheel</td>
</tr>
<tr class="odd">
<td>x</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>X coordinate of the mouse</td>
</tr>
<tr class="even">
<td>y</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>Y coordinate of the mouse</td>
</tr>
</tbody>
</table>
<h3 id="constants-4">Constants</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ENTER_WINDOW</td>
<td>integer</td>
<td>event type identifier for mouse entering event</td>
</tr>
<tr class="even">
<td>LEAVE_WINDOW</td>
<td>integer</td>
<td>event type identifier for mouse leaving event</td>
</tr>
<tr class="odd">
<td>LEFT_DCLICK</td>
<td>integer</td>
<td>event type identifier for left double click event</td>
</tr>
<tr class="even">
<td>LEFT_DOWN</td>
<td>integer</td>
<td>event type identifier for left mouse down event</td>
</tr>
<tr class="odd">
<td>LEFT_UP</td>
<td>integer</td>
<td>event type identifier for left mouse up event</td>
</tr>
<tr class="even">
<td>MIDDLE_DCLICK</td>
<td>integer</td>
<td>event type identifier for middle double click event</td>
</tr>
<tr class="odd">
<td>MIDDLE_DOWN</td>
<td>integer</td>
<td>event type identifier for middle mouse down event</td>
</tr>
<tr class="even">
<td>MIDDLE_UP</td>
<td>integer</td>
<td>event type identifier for middle mouse up event</td>
</tr>
<tr class="odd">
<td>MOTION</td>
<td>integer</td>
<td>event type identifier for mouse motion event</td>
</tr>
<tr class="even">
<td>MOUSEWHEEL</td>
<td>integer</td>
<td>event type identifier for mouse wheel rotation event</td>
</tr>
<tr class="odd">
<td>RIGHT_DCLICK</td>
<td>integer</td>
<td>event type identifier for right double click event</td>
</tr>
<tr class="even">
<td>RIGHT_DOWN</td>
<td>integer</td>
<td>event type identifier for right mouse down event</td>
</tr>
<tr class="odd">
<td>RIGHT_UP</td>
<td>integer</td>
<td>event type identifier for right mouse up event</td>
</tr>
</tbody>
</table>
<h2 id="outputstream">OutputStream</h2>
<p>Output stream class</p>
<h3 id="outputstream-file">OutputStream (file)</h3>
<p>Create a new output stream. You can open a file by passing one
parameter, or create an in-memory stream by passing no parameter.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>file: string|Path: File name or path referencing a file to open for
writing, or nil to create an in-memory stream</li>
</ul>
<h3 id="outputstreamclose-">outputStream:close ()</h3>
<p>Close the stream</p>
<h3 id="outputstreamseek-position-ansecurrent">outputStream:seek
(position, anse='current')</h3>
<p>Seek in the stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>position: integer: position to seek to</li>
<li>anse: string: one of 'begin', 'current' or 'end' to seek
respectively from the beginning of the stream, its current position, or
from the end.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the new position of the stream, or -1 if unknown</li>
</ul>
<h3 id="outputstreamtell-">outputStream:tell ()</h3>
<p>Tells the current position of the stream</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: the position of the stream, or -1 if unknown</li>
</ul>
<h3 id="outputstreamtostring-">outputStream:toString ()</h3>
<p>Converts all the content written to this stream into a string. It
works only for in-memory buffers created with the no-args
constructor.</p>
<p><strong>Returns:</strong></p>
<ul>
<li>string: content of the stream as a string. Note that the string is
returned as it is read. It may not be encoded in UTF-8, and may even be
binary data not humanly readable.</li>
</ul>
<h3 id="outputstreamwrite-data">outputStream:write (data)</h3>
<p>Write content to the stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>data: string: data to write</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: number of bytes written</li>
</ul>
<h3 id="outputstreamwritefrom-input">outputStream:writeFrom (input)</h3>
<p>Write all data read from an input stream</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>input: InputStream: input stream to read from</li>
</ul>
<h2 id="path">Path</h2>
<p>File class allowing file/directory/path manipulations</p>
<h3 id="path-volume-path-name-extension-format">Path (volume, path,
name, extension, format)</h3>
<p>Path constructor. You may specify from 1 to 4 parameters. With 1
parameter you specify the full path. With 2 parameters, you specify the
path and the name. With 3 parameters you specify path, name and
extension. With 4 parameters you specify volume, path, name and
extension. You can additionally specify path options by passing an
integer as the last parameter.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>volume: string: volume</li>
<li>path: string: directory path</li>
<li>name: string: file name</li>
<li>extension: string: file extension</li>
<li>format: integer: path otptions and format</li>
</ul>
<h3 id="pathappenddir-path">path:appendDir (path)</h3>
<p>Append a directory component at the end of the path</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: string: path component to append</li>
</ul>
<h3 id="pathdirexists-file">Path.dirExists (file)</h3>
<p>Check if a directory exists</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>file: File|string: path to test</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if a directory exists under the path given</li>
</ul>
<h3 id="pathexists-filepath-to-test">Path.exists (file=path to
test)</h3>
<p>Check if a file or directory exists</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>file: File|string:</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if a file or directory exists under the path
given</li>
</ul>
<h3 id="pathfileexists-file">Path.fileExists (file)</h3>
<p>Check if a file exists</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>file: File|string: path to test</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if a file exists under the path given</li>
</ul>
<h3 id="pathgetcwd-">Path.getCwd ()</h3>
<p>get the current working directory (CWD)</p>
<p><strong>Returns:</strong></p>
<ul>
<li>string: current working directory (CWD)</li>
</ul>
<h3 id="pathgetdircount-">path:getDirCount ()</h3>
<p>get the number of path segments of this File</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: number of path components of this File</li>
</ul>
<h3 id="pathgetdirs-">path:getDirs ()</h3>
<p>get all path segments of this File in a table</p>
<p><strong>Returns:</strong></p>
<ul>
<li>table: table of path segments</li>
</ul>
<h3 id="pathgethomedir-">Path.getHomeDir ()</h3>
<p>get the user's home directory</p>
<p><strong>Returns:</strong></p>
<ul>
<li>string: user's home directory</li>
</ul>
<h3 id="pathgethumanreadablesize-file">Path.getHumanReadableSize
(file)</h3>
<p>get a file size in a human readable form</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>file: File|integer: File object or file size in bytes</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: file size in an human readable form</li>
</ul>
<h3 id="pathhasext-">path:hasExt ()</h3>
<p>checks if this File has an extension</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if this file has an extension</li>
</ul>
<h3 id="pathhasname-">path:hasName ()</h3>
<p>checks if this File has a name</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if this file has a name</li>
</ul>
<h3 id="pathhasvolume-">path:hasVolume ()</h3>
<p>checks if this File has a volume part</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if this file has a vollume part</li>
</ul>
<h3 id="pathinsertdir-position-path">path:insertDir (position,
path)</h3>
<p>insert a directory component inside the path</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>position: integer: 0-based position where to insert the directory
component</li>
<li>path: string: path component to insert</li>
</ul>
<h3 id="pathisabsolute-">path:isAbsolute ()</h3>
<p>Checks if this File points to an absolute path</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the path to this File is absolute</li>
</ul>
<h3 id="pathiscasesensitive-">path:isCaseSensitive ()</h3>
<p>Checks if the file name is case sensitive</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the file name is case sensitive</li>
</ul>
<h3 id="pathisdir-">path:isDir ()</h3>
<p>Checks if this File is in fact a directory</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if this File is in fact a directory</li>
</ul>
<h3 id="pathisdirreadable-">path:isDirReadable ()</h3>
<p>checks if the directory is readable / listable</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the directory is readable / listable</li>
</ul>
<h3 id="pathisdirwritable-">path:isDirWritable ()</h3>
<p>checks if the directory is writable / allows to create or delete
files inside it</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the directory is writable / allows to create or
delete files inside it</li>
</ul>
<h3 id="pathisfileexecutable-">path:isFileExecutable ()</h3>
<p>checks if the file is executable</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the file is executable</li>
</ul>
<h3 id="pathisfilereadable-">path:isFileReadable ()</h3>
<p>checks if the file is readable</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the file is readable</li>
</ul>
<h3 id="pathisfilewritable-">path:isFileWritable ()</h3>
<p>checks if the file is writable</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the file is writable</li>
</ul>
<h3 id="pathisrelative-">path:isRelative ()</h3>
<p>Checks if this File points to a relative path</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the path to this File is relative</li>
</ul>
<h3 id="pathmakeabsolute-path">path:makeAbsolute (path)</h3>
<p>Transform a relative path to an absolute path</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: string: path to use as a base to make this path absolute</li>
</ul>
<h3 id="pathmakerelativeto-path">path:makeRelativeTo (path)</h3>
<p>Transform an absolute path to a relative path</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: string: path to use as a base to make this path relative
to</li>
</ul>
<h3 id="pathmkdir-path-permissions0-flags">Path.mkdir (path,
permissions=0, flags)</h3>
<p>create directories</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: File|string: path of directories to create</li>
<li>permissions: integer: permissions of the new directories</li>
<li>flags: integer: additional options</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the operation is successful</li>
</ul>
<h3 id="pathnormalize-options-path">path:normalize (options, path)</h3>
<p>normalize the path</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>options: integer: normalization options</li>
<li>path: string: path to use as a base</li>
</ul>
<h3 id="pathprependdir-path">path:prependDir (path)</h3>
<p>Prepend a path component</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: string: path component to prepend</li>
</ul>
<h3 id="pathremovedir-position">path:removeDir (position)</h3>
<p>Remove a path component</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>position: integer: position of the path component to remove</li>
</ul>
<h3 id="pathremovelastdir-">path:removeLastDir ()</h3>
<p>Remove the last path component of the path</p>
<h3 id="pathrmdir-path">Path.rmdir (path)</h3>
<p>delete a directory</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: File|string: directory to delete</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the operation is successful</li>
</ul>
<h3 id="pathsetcwd-path">path:setCwd (path)</h3>
<p>Change the current working directory (CWD)</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: File|string: new current working directory to set</li>
</ul>
<h3 id="pathsize-">path:size ()</h3>
<p>get the size of this File</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: size in bytes of this File</li>
</ul>
<h3 id="pathsplitpath-path">Path.splitPath (path)</h3>
<p>split a path into volume, path, name, extension</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: string: path to split</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: volume</li>
<li>string: path</li>
<li>string: name</li>
<li>string: extension</li>
<li>boolean: true if the path had an extension</li>
</ul>
<h3 id="pathstripextension-path">Path.stripExtension (path)</h3>
<p>Remove the extension of a file name</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>path: string: path from which to remove extension</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: path with extension removed</li>
</ul>
<h3 id="properties-8">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>absolutePath</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>full absolute path including file name</td>
</tr>
<tr class="even">
<td>extension</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>file extension</td>
</tr>
<tr class="odd">
<td>fullName</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>file name with extension</td>
</tr>
<tr class="even">
<td>fullPath</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>full path including file name</td>
</tr>
<tr class="odd">
<td>longPath</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>long form of full path</td>
</tr>
<tr class="even">
<td>name</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>file name without extension</td>
</tr>
<tr class="odd">
<td>path</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>path without file name</td>
</tr>
<tr class="even">
<td>shortPath</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>short form of full path</td>
</tr>
<tr class="odd">
<td>volume</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>volume</td>
</tr>
</tbody>
</table>
<h2 id="process">Process</h2>
<p>Process class allowing to execute external commands</p>
<h3 id="process-command">Process (command)</h3>
<p>Create and launch a new process</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>command: string: command-line containing the path to the executable
to run as well as all command-line parameters</li>
</ul>
<h3 id="processactivate-">process:activate ()</h3>
<p>Attempt to activate the main window of the process</p>
<h3 id="processbind-handler">process:bind (handler)</h3>
<p>Bind an event listener that will be triggered when the process
terminates</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>handler: function: handler that will be called when the process
terminates</li>
</ul>
<h3 id="processcloseoutput-">process:closeOutput ()</h3>
<p>Close the output stream connected to the standard input stream of the
process, indicating to it that you aren't going to send data anymore</p>
<h3 id="properties-9">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>errorAvailable</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if there is data available on the error stream</td>
</tr>
<tr class="even">
<td>errorStream</td>
<td>InputStream</td>
<td>true</td>
<td>false</td>
<td>input stream connected to the standard error stream of the
process</td>
</tr>
<tr class="odd">
<td>inputAvailable</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if there is data available on the input stream</td>
</tr>
<tr class="even">
<td>inputStream</td>
<td>InputStream</td>
<td>true</td>
<td>false</td>
<td>input stream connected to the standard output stream of the
process</td>
</tr>
<tr class="odd">
<td>outputStream</td>
<td>OutputStream</td>
<td>true</td>
<td>false</td>
<td>output stream connected to the standard input stream of the
process</td>
</tr>
<tr class="even">
<td>pid</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>process ID of the process</td>
</tr>
</tbody>
</table>
<h2 id="processevent">ProcessEvent</h2>
<p>Event notified when a process terminates</p>
<h3 id="properties-10">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exitCode</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>exit code of the process, usually 0 for success, any positive value
when the process failed, and negative value when the process couldn't be
executed at all</td>
</tr>
<tr class="even">
<td>pid</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>Process ID of the process</td>
</tr>
</tbody>
</table>
<h2 id="texteditor">TextEditor</h2>
<p>Type representing a text edition zone.</p>
<h3 id="texteditorappendtext-text">textEditor:appendText (text)</h3>
<p>Append some text at the end of the zone</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>text: string: text to append</li>
</ul>
<h3 id="texteditorcancopy-">textEditor:canCopy ()</h3>
<p>Checks if some text can be copied right now</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if some text can be copied</li>
</ul>
<h3 id="texteditorcancut-">textEditor:canCut ()</h3>
<p>Checks if some text can be cut right now</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if some text can be cut</li>
</ul>
<h3 id="texteditorcanpaste-">textEditor:canPaste ()</h3>
<p>Checks if some text can be pasted right now</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if some text can be pasted</li>
</ul>
<h3 id="texteditorcanredo-">textEditor:canRedo ()</h3>
<p>Checks if the last operation can be redone</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the last operation can be redone</li>
</ul>
<h3 id="texteditorcanundo-">textEditor:canUndo ()</h3>
<p>Checks if the last operation can be undone</p>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the last operation can be undone</li>
</ul>
<h3 id="texteditorchangevalue-text">textEditor:changeValue (text)</h3>
<p>Change the content of the zone without triggering events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>text: string: new text</li>
</ul>
<h3 id="texteditorclear-">textEditor:clear ()</h3>
<p>Clear the entire zone</p>
<h3
id="texteditorcolumnlinetoposition-x-y">textEditor:columnLineToPosition
(x, y)</h3>
<p>Convert a Column/Line based position into a character position</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>x: integer: X coordinate / column (1-based)</li>
<li>y: integer: Y coordinate / Line (1-based, 0=current line, negatives
counts from the end.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: 1-based charachter position</li>
</ul>
<h3 id="texteditorgetline-line0">textEditor:getLine (line=0)</h3>
<p>Get a line of text from the zone</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>line: integer: 1-based line number, 0=current line, negatives counts
from the end.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the text of the given line</li>
</ul>
<h3 id="texteditorgetlinelength-line0">textEditor:getLineLength
(line=0)</h3>
<p>Get the length of a line</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>line: integer: 1-based line number, 0=current line, negatives counts
from the end.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: length of the given line</li>
</ul>
<h3 id="texteditorgetnumberoflines-">textEditor:getNumberOfLines ()</h3>
<p>Gets the total number of lines of the zone</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: number of lines of the zone</li>
</ul>
<h3 id="texteditorgetrange-start-end">textEditor:getRange (start,
end)</h3>
<p>Get a range of text from the zone</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>start: integer: start of the range (1-based, negatives counts from
the end)</li>
<li>end: integer: end of the range (1-based, negatives counts from the
end)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the requested range of text</li>
</ul>
<h3 id="texteditorgetselection-">textEditor:getSelection ()</h3>
<p>Get the current position of the selection anchor and end points
(1-based)</p>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: anchor point of the current selection</li>
<li>integer: end point of the current selection</li>
</ul>
<h3
id="texteditorpositiontocolumnline-position0">textEditor:positionToColumnLine
(position=0)</h3>
<p>Convert a 1-based character position into an X/Y or Column/Line based
position</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>position: integer: 1-based character position, 0=current
position.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: X coordinate / Column</li>
<li>integer: Y coordinate / Line</li>
</ul>
<h3 id="texteditorremove-start-end">textEditor:remove (start, end)</h3>
<p>Remove some text from the zone</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>start: integer: position of the first character to remove (1-based,
negatives counts from the end)</li>
<li>end: integer: position of the last character to remove (1-based,
negatives counts from the end)</li>
</ul>
<h3 id="texteditorreplace-start-end-replacement">textEditor:replace
(start, end, replacement)</h3>
<p>Remove some text from the zone and replace it by something else</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>start: integer: position of the first character to remove (1-based,
negatives counts from the end)</li>
<li>end: integer: position of the last character to remove (1-based,
negatives counts from the end)</li>
<li>replacement: string: new text to be inserted at the place of the
removed region</li>
</ul>
<h3 id="texteditorselectall-">textEditor:selectAll ()</h3>
<p>Select the entire zone</p>
<h3 id="texteditorselectnone-">textEditor:selectNone ()</h3>
<p>Deselect everything</p>
<h3 id="texteditorsetselection-start-end">textEditor:setSelection
(start, end)</h3>
<p>Change the selection anchor and end points</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>start: integer: selection start / anchor point (1-based, negatives
counts from the end)</li>
<li>end: integer: selection end point (1-based, negatives counts from
the end)</li>
</ul>
<h3 id="texteditorwritetext-text">textEditor:writeText (text)</h3>
<p>Write some text at the current insertion point</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>text: string: text to write</li>
</ul>
<h3 id="properties-11">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>editable</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>tells if the zone is editable</td>
</tr>
<tr class="even">
<td>empty</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if the zone is empty</td>
</tr>
<tr class="odd">
<td>insertionPoint</td>
<td>integer</td>
<td>true</td>
<td>true</td>
<td>current position of the insertion point (1-based)</td>
</tr>
<tr class="even">
<td>lastPosition</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>position corresponding to the end of the zone</td>
</tr>
<tr class="odd">
<td>modified</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>Tells if the text content of the zone has been modified since the
last save</td>
</tr>
<tr class="even">
<td>selectedText</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>currently selected text</td>
</tr>
<tr class="odd">
<td>value</td>
<td>string</td>
<td>true</td>
<td>true</td>
<td>entire text of the zone</td>
</tr>
</tbody>
</table>
<h2 id="timer">Timer</h2>
<p>Timer class</p>
<h3 id="timerbind-handler">timer:bind (handler)</h3>
<p>Bind an event handler to this timer</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>handler: function: event handler to be triggered when the time is
out</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>handler: a event handle that can be passed to app.unbind</li>
</ul>
<h3 id="timerstart-interval-1-oneshotfalse">timer:start (interval=-1,
oneShot=false)</h3>
<p>Start the timer and run it periodically or one shot. If the timer is
already running, it is reset.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>interval: integer: interval in miliseconds. If 0 or negative, use
the previous interval.</li>
<li>oneShot: boolean: set time timer to be periodic (false) or one shot
(true)</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the timer has started, false if it was unable to
start</li>
</ul>
<h3 id="timerstartonce-interval-1">timer:startOnce (interval=-1)</h3>
<p>Start the timer tand run it only once (one shot). If the timer is
already running, it is reset.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>interval: integer: interval in miliseconds. If 0 or negative, use
the previous interval.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>boolean: true if the timer has started, false if it was unable to
start</li>
</ul>
<h3 id="timerstop-">timer:stop ()</h3>
<p>Stops the timer if it's running.</p>
<h3 id="properties-12">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>ID of the event generated</td>
</tr>
<tr class="even">
<td>interval</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>interval of the timer in miliseconds</td>
</tr>
<tr class="odd">
<td>oneShot</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if the timer is periodic (false) or one shot (true).</td>
</tr>
<tr class="even">
<td>running</td>
<td>boolean</td>
<td>true</td>
<td>false</td>
<td>tells if the timer is currently running (true) or stopped
(false).</td>
</tr>
</tbody>
</table>
<h2 id="webrequest">WebRequest</h2>
<p>Class allowing to make web requests</p>
<h3
id="webrequest-url-methodget-data-contenttype-contentlength">WebRequest
(url, method='GET', data, contentType, contentLength)</h3>
<p>Create a new web request</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>url: string: URL of the request</li>
<li>method: string: HTTP method of the request</li>
<li>data: string|InputStream: a string or an input stream to send as
request content. The method is automatically changed from 'GET' to
'POST' if necessary.</li>
<li>contentType: string: Content-Type for request content</li>
<li>contentLength: integer: length of the request content in bytes</li>
</ul>
<h3
id="webrequestsetdata-data-contenttype-contentlength">webRequest:setData
(data, contentType, contentLength)</h3>
<p>Set the request body</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>data: string|InputStream: string or input stream of the request
body</li>
<li>contentType: string: Content-Type of the request body</li>
<li>contentLength: integer: length of the data in bytes</li>
</ul>
<h3 id="webrequestsetheader-name-value">webRequest:setHeader (name,
value)</h3>
<p>SEt a request header</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>name: string: header name</li>
<li>value: string: header value</li>
</ul>
<h3 id="webrequestsubmit-callback">webRequest:submit (callback)</h3>
<p>Effectively launch the web request. The request is launched
asynchronously, and a callback function is called when the response is
fully received.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>callback: function: function to call when the response is received.
The fonction receive a WebResponse object as parameter.</li>
</ul>
<h3 id="properties-13">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>method</td>
<td>string</td>
<td>false</td>
<td>true</td>
<td>HTTP method of the request</td>
</tr>
<tr class="even">
<td>verifyDisabled</td>
<td>boolean</td>
<td>true</td>
<td>true</td>
<td>whether to ignore SSL/TLS certificate verifications. Note that
disabling SSL/TLS certificate verifications make requests less
secure.</td>
</tr>
</tbody>
</table>
<h2 id="webresponse">WebResponse</h2>
<p>Object containing a response to a web request</p>
<h3 id="webresponsegetheader-name">webResponse:getHeader (name)</h3>
<p>Get a response header</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>name: string: header name</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: header value, or empty string if not found</li>
</ul>
<h3 id="properties-14">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Readable</th>
<th>Writable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>contentLength</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>size in bytes of the response, or -1 if unknown</td>
</tr>
<tr class="even">
<td>contentType</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>Content type of the response</td>
</tr>
<tr class="odd">
<td>responseFileName</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>file name where the response is stored if storing in a file was
requested</td>
</tr>
<tr class="even">
<td>responseStream</td>
<td>InputStream</td>
<td>true</td>
<td>false</td>
<td>Get an input stream for reading the response content</td>
</tr>
<tr class="odd">
<td>responseText</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>content of the response as a string. Note that the string is
returned as it is read. It may not be encoded in UTF-8, and may even be
binary data not humanly readable.</td>
</tr>
<tr class="even">
<td>status</td>
<td>integer</td>
<td>true</td>
<td>false</td>
<td>HTTP response code of the response, for example 200</td>
</tr>
<tr class="odd">
<td>statusText</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>Text of the HTTP response code, for example 'OK'</td>
</tr>
<tr class="even">
<td>suggestedFileName</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>suggested file name for downloading a file</td>
</tr>
<tr class="odd">
<td>url</td>
<td>string</td>
<td>true</td>
<td>false</td>
<td>final URL of the resource. This can be different from the original
requested URL in case of redirection.</td>
</tr>
</tbody>
</table>
<h2 id="io">io</h2>
<p>Additions to the standard io lua module</p>
<h3 id="ioreadfile-filename-properties">io.readfile (filename,
properties)</h3>
<p>Reads a file from disk</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>filename: string: name of the file to read</li>
<li>properties: table: table of properties specifying encoding, line
ending, etc.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: content of the file, read and decoded as requested</li>
</ul>
<h3 id="iowritefile-filename-text-properties">io.writefile (filename,
text, properties)</h3>
<p>Write a file to disk</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>filename: string: name of the file to write to</li>
<li>text: string: text content of the file</li>
<li>properties: table: table of properties specifying encoding, line
ending, etc.</li>
</ul>
<h2 id="json">json</h2>
<p>JSON parsing library</p>
<h3 id="jsondump-values">json.dump (values...)</h3>
<p>Dump a lua value into JSON</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>values...: any: any lua values to convert to JSON</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the resulting JSON string</li>
</ul>
<h3 id="jsonload-jsonstring">json.load (jsonString...)</h3>
<p>Load JSON data</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>jsonString...: string: JSON strings to parse</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the resulting lua object parsed from JSON</li>
</ul>
<h2 id="pcre">pcre</h2>
<p>PCRE2 regular expression support</p>
<h3 id="pcrefind-subject-pattern-start1">pcre.find (subject, pattern,
start=1)</h3>
<p>Works almost like string.find, using PCRE2 regular expression instead
of lua pattern syntax: search for the first match and return the
position of where it has been found</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>subject: string: subject string</li>
<li>pattern: string: PCRE2 regular expression pattern. By starting the
pattern with /, you can specify options with the traditional
/pattern/options syntax as known in PHP PCRE or perl. Available options:
i=ignore case, m=multiline, s=dot all, x=extended, u=unicode UCP
extended support, U=ungreedy, A=anchored, D=dollar end only, E=end
ancohred, J=allow duplicate names.</li>
<li>start: integer: starting position where to start the search</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>integer: starting position of the first match</li>
<li>integer: ending position of the first match</li>
<li>string...: matched subgroups</li>
</ul>
<h3 id="pcregmatch-subject-pattern-start1">pcre.gmatch (subject,
pattern, start=1)</h3>
<p>Works almost like string.gmatch, using PCRE2 regular expression
instead of lua pattern syntax: return an iterator explist to iterate
over each matches of the string.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>subject: string: subject string</li>
<li>pattern: string: PCRE2 regular expression pattern (see
string.find)</li>
<li>start: integer: starting position where to start the search</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>function: iterator function</li>
<li>userdata: iterator state data</li>
</ul>
<h3 id="pcregsub-subject-pattern-start1-replacement-max0">pcre.gsub
(subject, pattern, start=1, replacement, max=0)</h3>
<p>Works almost like string.gsub, using PCRE2 regular expression instead
of lua pattern syntax: perform a global substitution, i.e. replace each
match by a replacement</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>subject: string: subject string</li>
<li>pattern: string: PCRE2 regular expression pattern (see
string.find)</li>
<li>start: integer: optional: starting position where to starting search
for matches</li>
<li>replacement: string|function|table: replacement to apply: whether a
replacement string with PCRE2 substitution syntax, a function receiving
matched groups as parameters and returning the replacement string, or a
table which will be looked up with the first matched group as a key. In
a replacement string, Use $0 to $9 or $g{name} to refer to matched
groups by index or by name.</li>
<li>max: integer: maximum number of replacements to make, &lt;=0
indicating no limit</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: new string with all replacements performed</li>
<li>integer: number of replacements made</li>
</ul>
<h3 id="pcrematch-subject-pattern-start1">pcre.match (subject, pattern,
start=1)</h3>
<p>Works almost like string.match, using PCRE2 regular expression
instead of lua pattern syntax: search for the first match and return the
matched groups</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>subject: string: subject string</li>
<li>pattern: string: PCRE2 regular expression pattern (see
string.find)</li>
<li>start: integer: starting position where to start the search</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string...: matched subgroups</li>
</ul>
<h2 id="utf8">utf8</h2>
<p>Additions to the utf8 lua module</p>
<h3 id="utf8capitalize-string">utf8.capitalize (string)</h3>
<p>Capitalize the string</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>string: string: string to capitalize</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the transformed string</li>
</ul>
<h3 id="utf8decode-string-encoding">utf8.decode (string, encoding)</h3>
<p>Decode a string from some encoding into UTF-8</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>string: string: the string to decode</li>
<li>encoding: string: the encoding in which the initial string is
encoded</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the decoded string in UTF-8</li>
</ul>
<h3 id="utf8encode-string-encoding">utf8.encode (string, encoding)</h3>
<p>Encode an UTF-8 string into some encoding</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>string: string: the UTF-8 string to be encoded</li>
<li>encoding: string: the encoding to encode to</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the string encoded in the given encoding</li>
</ul>
<h3 id="utf8lower-string">utf8.lower (string)</h3>
<p>Turn a string into lowercase</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>string: string: string to translate to lowercase</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the transformed string</li>
</ul>
<h3 id="utf8upper-string">utf8.upper (string)</h3>
<p>Turn a string into uppercase</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>string: string: string to translate to uppercase</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>string: the transformed string</li>
</ul>
<hr />
</body>
</html>
